<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Palm Tree: Lock Free B+Tree by runshenzhu</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Palm Tree: Lock Free B+Tree</h1>
      <h2 class="project-tagline"></h2>
      <a href="https://github.com/runshenzhu/618-final" class="btn">View on GitHub</a>
      <a href="https://github.com/runshenzhu/618-final/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/runshenzhu/618-final/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <p>We decided to change from the mobile deep learning idea (see old proposal). Here is the reasons:</p>

<ul>
<li>There is a gap between knowledge about deep learning and manipulating with industrial class deep learning frameworks.</li>
<li>We find it hard to find a lightweight framework and a simple neural nets to get started, we have spent couple of days read the Caffe code and MXNet code but find them too complicated to start with</li>
<li>It is not easy to implement the compression ideas, mainly because it needs us to have a high performace costumized training pipeline, which is hard to get if we start from scratch</li>
<li>We decided to choose a project that is challenging, and that we can quickly get started with. We finally decided to implement a lock free data strcture: lock free B+Tree.</li>
</ul>

<h3>
<a id="summary" class="anchor" href="#summary" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Summary:</h3>

<p>We are going to implement a high performance lock-free B+ tree based by firstly following the Intel Palm Tree [1] paper. The main idea of palm tree is to batch queries and use Bulk Synchronization Protocol to solve race conditions without introducing latches or locks. The papers have basic ideas and instructions of how to implement a Palm Tree, but lacks of many implementation details, e.g. it seems that the original Palm Tree does not support scan operation, which is very important for a ordered index structure, such as the one used in a database. We plan to implement the Palm Tree from scratch, and port a nice interfaces, similar to that one of STL map.</p>

<h3>
<a id="background" class="anchor" href="#background" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Background:</h3>

<p>B+ tree is one of the most widely used data structures, and has a extensive usage in database systems. In highly concurrently environment, race is primarily avoided by using locks or latches. As core counts on current processors increase, the contention from lock hinders the scalibility. It is imperative to develop scalable latch-free concurrency control on B+ trees. </p>

<h3>
<a id="the-challenges-are" class="anchor" href="#the-challenges-are" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>The challenges are:</h3>

<ul>
<li>Lock-free programming is very tricky, hard to recognize potential race conditions</li>
<li>It is important for the tree to be architecture friendly, so that many performance tuning will be needed to determine the best settings of the data structure</li>
<li>The main idea of palm tree is to have multiple threads cooperatively process tree operations in batch.</li>
</ul>

<h3>
<a id="resources" class="anchor" href="#resources" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Resources:</h3>

<p>A multi-core machine to evaluate the performance</p>

<h3>
<a id="our-goals" class="anchor" href="#our-goals" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Our goals:</h3>

<ul>
<li>75% goal: 

<ul>
<li>Implementing a multi-threaded lock-free B+Tree (Palm Tree)</li>
<li>Support Scan operation</li>
</ul>
</li>
<li>100% goal:

<ul>
<li>Accelerate Palm Tree using SIMD intrinsics</li>
<li>Benchmark and analysis</li>
<li>Deliverables: a concurrent lock free B+Tree library, with interfaces similar to that of STL map. Test suit and benchmark of the library and documentation.</li>
</ul>
</li>
</ul>

<h3>
<a id="platform-choice" class="anchor" href="#platform-choice" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Platform choice:</h3>

<ul>
<li>Multi-core CPU</li>
</ul>

<h3>
<a id="schedule" class="anchor" href="#schedule" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Schedule:</h3>

<ul>
<li>4/4 - 4/10 Read and undstand related papers. Dicessue the interface of palm tree.</li>
<li>4/11- 4/16 Get a correct, unoptimized implementation. (75% goal)</li>
<li>4/17 - 4/24 Uitilize SIMD for search and sort operations.</li>
<li>4/25 - 5/1 Fine-tune the Palm tree and do benchmark.</li>
<li>5/2 - 5/8 Write up and presentation.</li>
</ul>

<p>References:
[1] PALM: Parallel Architecture-Friendly Latch-Free Modifications to B+ Trees on Many-Core Processors.</p>

<h1>
<a id="middle-checkpoint" class="anchor" href="#middle-checkpoint" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Middle checkpoint:</h1>

<p>Since we have spent much time in reading papers and code about deep learning evaluation, we only have limited time before the middle checkpoint for the new project idea. By now, we have sketched out the components of Palm Tree: the main datastructures, the inter-thread communication method and the public interfaces of PalmTree. We have also implemented most of the B+Tree operations which will be the basic of our concurrent implementation.</p>

<p>We believe that we can still finish the project on time with good quality even if we switched the project. In another one week we can have a baseline workable concurrent B+Tree, then we have 1-2 weeks to do benchmark and tune for performance. The final goal for this project is to have a concurrent B+Tree that has similar performance as Intel’s implementation. As far as our knowledge, there is no open source implementation of concurrent lock-free B+Tree, (MassTree might be the only exception but it has a poor interfaces to pick up), we plan to provide a open source high quality implementation.</p>

<h3>
<a id="we-plan-to-show-several-graphs-on-the-competition" class="anchor" href="#we-plan-to-show-several-graphs-on-the-competition" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>We plan to show several graphs on the competition</h3>

<ul>
<li>Palm Tree vs. sequential B+Tree vs. fine grained B+Tree with different number of cores</li>
<li>Palm Tree throughput against different tree size</li>
<li>Palm Tree Read/Write performance against different degree of contention</li>
</ul>

<h3>
<a id="issues-we-concerned-most" class="anchor" href="#issues-we-concerned-most" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Issues we concerned most:</h3>

<ul>
<li>We have been exhausted in searching for good project, we finally decided to implement the idea of a paper, it might not be as interesting as doing a brand new project to both us and the course staff. I don’t know if it will harm our grades on the final project?</li>
<li>We may be a little bit left behind, but we are confident that we can finally make it work, we have carefully discussed the details of the Palm Tree algorithm and started coding very quickly and made some progress. Is it OK that we switch to this project?</li>
</ul>

<h1>
<a id="old-proposal" class="anchor" href="#old-proposal" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>OLD PROPOSAL</h1>

<p>We are going to implement memory and energy efficient deep neural networks on mobile devices. The basic idea is to accelerate prediction process on already-trained model on a mobile GPU such as Tegra K1/X1. </p>

<h3>
<a id="background-1" class="anchor" href="#background-1" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Background</h3>

<p>Deep learning is a promising and popular AI technology that may greatly change the future world. If we can run deep learning models efficiently on mobile devices, it makes normal people the able to use state-of-the-art AI technologies in daily lives. However, deep learning is both memory and computational complicated, how to run it efficiently on mobile devices is a challenging problem.</p>

<p>Recent research about bitwise neural network [1][2] can result in 58x faster convolutional operations and 32x memory savings, and deep compression [3] reduces the storage and energy required to run inference on large networks. All these techniques make deep learning running on resource constrained mobile devices possible.</p>

<h3>
<a id="challenges" class="anchor" href="#challenges" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Challenges</h3>

<ul>
<li>Mobile device has constrained memory and storage, but nerual networks with decent accuracy can easily have tens of thousands parameters</li>
<li>Enegy consumption is critical for mobile devices, nerual network prediction is computationally complicated</li>
<li>while good prediction accuracy requires significant amount of computing resources, it's hard for mobile device to meet this requirement.</li>
</ul>

<h3>
<a id="resources-1" class="anchor" href="#resources-1" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Resources:</h3>

<ul>
<li>Tegra K1 Dev Kit</li>
</ul>

<h3>
<a id="goals" class="anchor" href="#goals" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Goals</h3>

<ul>
<li>75% goal

<ul>
<li>Import trained models from popular deep learning frameworks such as Caffe to mobile devices. We plan to fisrt import AlexNet.</li>
<li>Run neural network prediction on Tegra K1 (GPU and CPU).</li>
</ul>
</li>
<li>100% goal

<ul>
<li>Achieve real time neural network prediction in on Tegra K1.</li>
<li>Evalute memory efficiency and energy efficiency, determine expensive part of the prediction process.</li>
<li>Reduce runtime memory footprint and enery footprint based on the evaluation results. Implementing deep compression and bitwise NN if needed.</li>
</ul>
</li>
<li>125% goal

<ul>
<li>Beat state of the art NN prediction runtime on mobile devices.</li>
</ul>
</li>
</ul>

<h3>
<a id="platform-choice-1" class="anchor" href="#platform-choice-1" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Platform choice</h3>

<p>Tegra K1 chip: this chip has a 192-core GPU and a quad-core ARM CPU, we can use this heterogeneity to evaluate deep learning runtime performance on different platforms. This chip is also targeting at mobile devices, for example the chip is small in size, and is very energy efficient. Besides, the GPU supports cuDNN, a cuda GPU deep learning framework that is widely used.</p>

<h3>
<a id="schedule-1" class="anchor" href="#schedule-1" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Schedule</h3>

<ul>
<li>4/4 - 4/10 Set up the development environment. Read and undstand related papers.</li>
<li>4/11- 4/16 Get a correct, unoptimized implementation. (75% goal)</li>
<li>4/17 - 4/24 Implement deep compression to reduce the mode size.</li>
<li>4/25 - 5/1 Implement XNOR-NET to accelarate prediction. (100% goal)</li>
<li>5/2 - 5/8 Benchmark and Write up.</li>
</ul>

<h3>
<a id="references" class="anchor" href="#references" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>References</h3>

<p>[1] XNOR-Net: ImageNet Classification Using Binary Convolutional Neural Networks</p>

<p>[2] Bitwise Neural Networks</p>

<p>[3] Deep Compression: Compressing Deep Neural Networks with Pruning, Trained Quantization and Huffman Coding</p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/runshenzhu/618-final">Palm Tree: Lock Free B+Tree</a> is maintained by <a href="https://github.com/runshenzhu">runshenzhu</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
